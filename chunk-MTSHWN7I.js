import{a as $}from"./chunk-RQYTUILH.js";import{a as Q,b as X,c as H}from"./chunk-YQXRXCQE.js";import{b as Y}from"./chunk-4IKHQH3D.js";import{f as M,h as L}from"./chunk-U6AR7ORX.js";import{$ as j,Ba as G,Ca as U,Fa as V,Ga as z,Na as B,ca as k,ia as T,ja as Z,la as _,na as R,oa as I,ta as F,ua as N,va as W}from"./chunk-H5IADLD3.js";import"./chunk-4MNQX6OK.js";import{$b as w,Db as o,Eb as a,Fb as l,Nb as D,Ob as g,Sb as b,Tb as O,Ub as v,Va as d,Y as E,Yb as h,_a as p,ac as y,bc as S,cc as C,fb as f,gb as P,la as u,lb as x,ma as A,sb as c,yb as m}from"./chunk-77CAPYCR.js";import"./chunk-2NFLSA4Y.js";var q=(()=>{class n{static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275mod=P({type:n})}static{this.\u0275inj=E({})}}return n})();var et=["chart"];function it(n,e){n&1&&(u(),l(0,"image",27))}function at(n,e){n&1&&(u(),l(0,"rect",28))}function nt(n,e){if(n&1&&(u(),l(0,"polyline",29)),n&2){let i=g();c("points",i.svgPoints)}}function st(n,e){if(n&1&&(u(),l(0,"circle",40),o(1,"text",41),h(2,"Start"),a()),n&2){let i=g();c("cx",i.startPoint.x)("cy",i.startPoint.y),d(),c("x",i.startPoint.x+15)("y",i.startPoint.y)}}function ot(n,e){if(n&1&&(o(0,"span",35),h(1),a()),n&2){let i=g();d(),w(" Page ",i.currentPage," (",i.currentPageData.length," records) ")}}var J=class n{constructor(e,i){this.router=e;this.route=i;this.areaSmoothChart={series:[{name:"series1",data:[]}],chart:{height:350,type:"area"},dataLabels:{enabled:!1},stroke:{curve:"smooth"},xaxis:{categories:[]},tooltip:{x:{format:"HH:mm:ss"}}},this.areaSmoothChartMaps={series:[{name:"Route Path",data:[]}],chart:{type:"line",height:400,zoom:{enabled:!0}},xaxis:{type:"numeric",title:{text:"Longitude"}},yaxis:{title:{text:"Latitude"}},stroke:{curve:"smooth",width:3}}}chart;showRoutePath=!0;toppingList=["Extra cheese","Mushroom","Onion","Pepperoni","Sausage","Tomato"];svgPoints="";startPoint={x:0,y:0,lat:0,long:0};hasRouteData=!1;trackImage=null;pageSize=10;currentPageData=[];currentPage=1;showPageDataOnly=!0;subscriptions=[];areaSmoothChart;areaSmoothChartMaps;allLogger=[];ngOnInit(){}ngOnDestroy(){this.subscriptions.forEach(e=>e.unsubscribe())}navigateToDashboard(){this.router.navigate(["/pages","dashboard"])}formatGpsTimeToText(e){let i=e.slice(0,2),t=e.slice(2,4),s=parseFloat(e.slice(4)),r=Math.floor(s).toString().padStart(2,"0"),K=Math.round(s%1*1e3).toString().padStart(3,"0");return`${i}:${t}:${r}:${K}`}formatToTimeLabel(e){let i=e.slice(0,2),t=e.slice(2,4),s=Math.floor(parseFloat(e.slice(4))).toString().padStart(2,"0");return`${i}:${t}:${s}`}updateChartWithData(e){let i=e.slice(-1e3),t=i.map(r=>({x:this.formatGpsTimeToText(r.time),y:parseFloat(r.velocity.toString())})),s=i.map(r=>({x:this.formatGpsTimeToText(r.time),y:parseFloat(r.height)}));this.areaSmoothChart.series=[{name:"velocity",data:t},{name:"height",data:s}],this.areaSmoothChart.xaxis={categories:i.map(r=>this.formatToTimeLabel(r.time))},this.chart&&this.chart.updateOptions({series:this.areaSmoothChart.series,xaxis:this.areaSmoothChart.xaxis}),this.updateMapWithAllData()}onToggleChartMode(){console.log("Toggle chart mode:",this.showPageDataOnly),this.showPageDataOnly?this.updateChartWithPageData(this.currentPageData):this.allLogger.length>0&&this.updateChartWithData(this.allLogger)}updateChartWithPageData(e){if(!e||e.length===0){this.areaSmoothChart.series=[{name:"velocity",data:[]},{name:"height",data:[]}],this.areaSmoothChart.xaxis={categories:[]},this.chart&&this.chart.updateOptions({series:this.areaSmoothChart.series,xaxis:this.areaSmoothChart.xaxis});return}let i=e.map(s=>({x:this.formatGpsTimeToText(s.time),y:parseFloat(s.velocity.toString())})),t=e.map(s=>({x:this.formatGpsTimeToText(s.time),y:parseFloat(s.height)}));this.areaSmoothChart.series=[{name:"velocity",data:i},{name:"height",data:t}],this.areaSmoothChart.xaxis={categories:e.map(s=>this.formatToTimeLabel(s.time))},this.chart&&this.chart.updateOptions({series:this.areaSmoothChart.series,xaxis:this.areaSmoothChart.xaxis}),this.updateMapWithPageData(e)}updateMapWithPageData(e){if(!e||e.length===0){this.areaSmoothChartMaps.series=[{name:"Route Path",data:[]}];return}let i=e.filter(t=>t.lat&&t.long).map(t=>({x:parseFloat(t.long),y:parseFloat(t.lat)})).filter(t=>!isNaN(t.x)&&!isNaN(t.y));console.log("GPS Path Data:",i),this.areaSmoothChartMaps={series:[{name:"Route Path",data:i}],chart:{type:"line",height:400,zoom:{enabled:!0}},xaxis:{type:"numeric",title:{text:"Longitude"}},yaxis:{title:{text:"Latitude"}},stroke:{curve:"smooth",width:3,colors:["#007bff"]},markers:{size:4,colors:["#007bff"],strokeColors:"#fff",strokeWidth:2},tooltip:{x:{formatter:function(t){return"Longitude: "+t.toFixed(6)}},y:{formatter:function(t){return"Latitude: "+t.toFixed(6)}}}}}updateMapWithAllData(){if(!this.allLogger||this.allLogger.length===0)return;let e=this.allLogger.slice(-1e3);this.updateMapWithPageData(e)}onMouseEnterZoom(){document.body.style.overflow="hidden"}onMouseLeaveZoom(){document.body.style.overflow="auto"}static \u0275fac=function(i){return new(i||n)(p(L),p(M))};static \u0275cmp=f({type:n,selectors:[["app-logger"]],viewQuery:function(i,t){if(i&1&&b(et,5),i&2){let s;O(s=v())&&(t.chart=s.first)}},decls:90,vars:6,consts:[[1,"pt-2"],[1,"container"],[1,"row","w-100"],[1,"col-3","pt-2"],[1,"mat-input-form"],[1,"w-100"],["matInput","","disabled","","value","Thailand Super Pickup D2",1,"text-center"],["matInput","","disabled","","value","Pickup",1,"text-center"],["matInput","","disabled","","value","Race 5",1,"text-center"],["matInput","","disabled","","value","\u0E19\u0E32\u0E22\u0E17\u0E14\u0E2A\u0E2D\u0E1A TEST01",1,"text-center"],[1,"container",2,"margin-top","20px"],[1,"col-2","pt-2"],["matInput","","disabled","","value","8",1,"text-center"],["matInput","","disabled","","value","TSS001",1,"text-center"],["matInput","","disabled","","value","Offline",1,"text-center"],["matInput","","disabled","","value","0",1,"text-center"],[1,"col-4","pt-2"],["type","button",1,"btn","btn-warning","w-100","h-50","text-light"],[1,"col-12"],[1,"card"],[1,"card-header"],[1,"card-body"],[1,"form-check","form-switch","mb-2"],["type","checkbox","id","toggleRoutePath",1,"form-check-input",3,"ngModelChange","ngModel"],["for","toggleRoutePath",1,"form-check-label"],[1,"track-image-container","text-center"],["viewBox","0 0 800 600",2,"max-width","800px","max-height","600px"],["href","images/map-race/outline-map-baangsan.png",2,"max-width","800px","max-height","600px"],["fill","#ffffff",2,"max-width","800px","max-height","600px"],["fill","none","stroke","#007bff","stroke-width","2","opacity","0.9"],[1,"mt-3","d-flex","align-items-center","gap-4","flex-wrap"],[1,"row","w-100","mt-5"],[1,"col-md-12"],[1,"card",2,"margin-bottom","0px"],[1,"card-header","d-flex","justify-content-between","align-items-center"],[1,"badge","bg-primary","ms-2"],[1,"d-flex","align-items-center","gap-2"],[1,"form-check","form-switch"],["type","checkbox","id","showPageDataToggle",1,"form-check-input",3,"ngModelChange","change","ngModel"],["for","showPageDataToggle",1,"form-check-label"],["r","10","fill","#28a745","stroke","#fff","stroke-width","3"],["font-size","20","fill","#28a745","font-weight","bold"]],template:function(i,t){i&1&&(o(0,"mat-toolbar",0)(1,"mat-toolbar-row")(2,"div",1)(3,"div",2)(4,"div",3)(5,"form",4)(6,"mat-form-field",5)(7,"mat-label"),h(8,"Race"),a(),l(9,"input",6),a()()(),o(10,"div",3)(11,"form",4)(12,"mat-form-field",5)(13,"mat-label"),h(14,"\u0E23\u0E38\u0E48\u0E19"),a(),l(15,"input",7),a()()(),o(16,"div",3)(17,"form",4)(18,"mat-form-field",5)(19,"mat-label"),h(20,"Session"),a(),l(21,"input",8),a()()(),o(22,"div",3)(23,"form",4)(24,"mat-form-field",5)(25,"mat-label"),h(26,"\u0E0A\u0E37\u0E48\u0E2D\u0E19\u0E31\u0E01\u0E41\u0E02\u0E48\u0E07"),a(),l(27,"input",9),a()()()()()()(),o(28,"div",10)(29,"div",2)(30,"div",11)(31,"form",4)(32,"mat-form-field",5)(33,"mat-label"),h(34,"\u0E2B\u0E21\u0E32\u0E22\u0E40\u0E25\u0E02\u0E23\u0E16"),a(),l(35,"input",12),a()()(),o(36,"div",11)(37,"form",4)(38,"mat-form-field",5)(39,"mat-label"),h(40,"Logger ID"),a(),l(41,"input",13),a()()(),o(42,"div",11)(43,"form",4)(44,"mat-form-field",5)(45,"mat-label"),h(46,"Session"),a(),l(47,"input",14),a()()(),o(48,"div",11)(49,"form",4)(50,"mat-form-field",5)(51,"mat-label"),h(52,"Warning"),a(),l(53,"input",15),a()()(),o(54,"div",16)(55,"button",17),h(56," Clear Warning "),a()()(),o(57,"div",2)(58,"div",18)(59,"div",19)(60,"div",20)(61,"h5"),h(62,"Racer Detail"),a()(),o(63,"div",21)(64,"div",22)(65,"input",23),C("ngModelChange",function(r){return S(t.showRoutePath,r)||(t.showRoutePath=r),r}),a(),o(66,"label",24),h(67,"\u0E41\u0E2A\u0E14\u0E07\u0E40\u0E2A\u0E49\u0E19\u0E17\u0E32\u0E07\u0E01\u0E32\u0E23\u0E27\u0E34\u0E48\u0E07"),a()(),o(68,"div",25),u(),o(69,"svg",26),l(70,"image",27),x(71,it,1,0,":svg:image",27)(72,at,1,0,":svg:rect",28)(73,nt,1,1,":svg:polyline",29)(74,st,3,4),a()(),A(),l(75,"div",30),a()()()(),o(76,"div",31)(77,"div",32)(78,"div",33)(79,"div",34)(80,"h5"),h(81," Graph Realtime Average AFR "),x(82,ot,2,2,"span",35),a(),o(83,"div",36)(84,"div",37)(85,"input",38),C("ngModelChange",function(r){return S(t.showPageDataOnly,r)||(t.showPageDataOnly=r),r}),D("change",function(){return t.onToggleChartMode()}),a(),o(86,"label",39)(87,"small"),h(88,"Page Data Only"),a()()()()(),l(89,"div",21),a()()()()),i&2&&(d(65),y("ngModel",t.showRoutePath),d(6),m(t.trackImage?71:t.trackImage?-1:72),d(2),m(t.showRoutePath?73:-1),d(),m(t.hasRouteData?74:-1),d(8),m(t.currentPageData.length>0?82:-1),d(3),y("ngModel",t.showPageDataOnly))},dependencies:[F,I,k,T,Z,R,_,U,G,W,z,V,B,N,j,$,Y,H,X,Q,q],styles:[".mat-toolbar[_ngcontent-%COMP%]{background:#212529;color:#fff}"]})};export{J as LoggerComponent};
