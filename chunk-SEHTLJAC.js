import{a as de,i as pe}from"./chunk-XTIY7LZT.js";import{A as Me,B as Ce,C as Ee,D as Se,E as _e,F as we,G as xe,I as Le,K as ye,L as De,M as Te,P as Fe,Q as Ie,c as Z,d as $,e as H,f as z,s as ue}from"./chunk-KIB52OBY.js";import{$ as b,Ba as ae,Ca as le,Ga as se,Ia as me,Na as ge,Oa as ce,Pa as fe,Qa as he,Ra as ve,Ta as be,fa as J,ia as Q,ja as U,la as X,ma as Y,oa as ee,pa as te,qa as ie,ra as re,sa as M,ta as C,ua as oe,va as ne}from"./chunk-XYB54QG3.js";import{p as j,r as K}from"./chunk-IDTDKUG7.js";import{$b as A,Bb as O,Db as w,Eb as x,F as N,Fb as L,Gb as r,Hb as o,Ib as f,Mb as y,R as S,Rb as h,Sb as D,Xa as m,ac as a,bb as c,bc as T,ca as _,cc as F,ib as v,ic as P,ka as d,la as p,ma as V,na as k,ob as q,uc as G,wb as u,y as W,yb as R}from"./chunk-IHGSUVEV.js";import"./chunk-EQDQRRRY.js";var E=class n{ngOnInit(){}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=v({type:n,selectors:[["app-reset-warning-logger"]],features:[P([ue()])],decls:14,vars:0,consts:[["mat-dialog-title","",1,"text-center"],[1,"text-center"],[2,"color","#D88C0C"],[1,"row"],[1,"col-12","d-flex","justify-content","mt-2"],["type","button","matButton","","mat-dialog-close","",1,"btn","btn-danger"],["type","button","matButton","","mat-dialog-close","","cdkFocusInitial","",1,"btn","btn-success"]],template:function(e,i){e&1&&(r(0,"h1",0),a(1,` Warning Logger
`),o(),r(2,"mat-dialog-content")(3,"h5",1),a(4," \u0E15\u0E49\u0E2D\u0E07\u0E01\u0E32\u0E23 Reset \u0E04\u0E48\u0E32 "),r(5,"b",2),a(6,"Warning"),o(),a(7," \u0E17\u0E31\u0E49\u0E07\u0E2B\u0E21\u0E14\u0E2B\u0E23\u0E37\u0E2D\u0E44\u0E21\u0E48 ? "),o(),r(8,"div",3)(9,"div",4)(10,"button",5),a(11,"\u0E22\u0E01\u0E40\u0E25\u0E34\u0E01"),o(),r(12,"button",6),a(13,"\u0E22\u0E37\u0E19\u0E22\u0E31\u0E19"),o()()()())},dependencies:[b,$,z,H,C],styles:["button[_ngcontent-%COMP%]{margin-right:8px}"],changeDetection:0})};function Ve(n,t){if(n&1&&(r(0,"mat-option",8),a(1),o()),n&2){let e=t.$implicit;u("value",e.value),m(),T(e.name)}}function ke(n,t){if(n&1&&(r(0,"div",29),f(1,"img",31),o()),n&2){let e=D().$implicit;u("matBadge",e.numberWarning)}}function qe(n,t){n&1&&(r(0,"div",30),f(1,"img",32),o())}function Re(n,t){if(n&1){let e=y();r(0,"div",20),h("click",function(){d(e);let l=D();return p(l.navigateToLoggerDetail())}),r(1,"mat-card",21)(2,"mat-card-content")(3,"div",18)(4,"div",22)(5,"h3",23)(6,"span",24),a(7),o()()(),r(8,"div",22)(9,"h3",23)(10,"span",24),a(11),o()()()(),f(12,"hr",25),r(13,"div",26)(14,"div",27)(15,"button",28),a(16," Offline "),o(),q(17,ke,2,1,"div",29)(18,qe,2,0,"div",30),o()()()()()}if(n&2){let e=t.$implicit;m(),R("alert",e.warningDetector)("warning",e.numberWarning<=3&&e.numberWarning>=1),m(6),F("No.",e.carNumber,""),m(4),T(e.loggerId),m(6),O(e.numberWarning>0?17:18)}}var Be=class n{constructor(t,e,i,l,s,g){this.router=t;this.route=e;this.eventService=i;this.toastr=l;this.fb=s;this.cdr=g}subscriptions=[];allLoggers=[];dialog=_(Z);onShowAllLoggers=[];sortStatus="";showRoutePath=!0;filterLogList=[{name:"Logger \u0E17\u0E31\u0E49\u0E07\u0E2B\u0E21\u0E14",value:"all"},{name:"\u0E40\u0E09\u0E1E\u0E32\u0E30 \u0E04\u0E27\u0E31\u0E19\u0E04\u0E33",value:"allSmokeDetect"},{name:"\u0E40\u0E09\u0E1E\u0E32\u0E30 Warning",value:"allWarning"}];filterLogger=new Y(["all"],{nonNullable:!0});wasAllSelected=this.filterLogger.value.includes("all");_formBuilder=_(M);filterIsAnd=!1;isChecked=!0;formGroup=this._formBuilder.group({sortType:[!0,J.requiredTrue]});ngOnInit(){let t=this.eventService.getLogger().pipe(N(1)).subscribe({next:i=>{this.allLoggers=i??[],this.updateView(this.allLoggers),this.cdr.markForCheck()},error:i=>console.error("Error loading matchList:",i)});this.subscriptions.push(t);let e=W(this.filterLogger.valueChanges.pipe(S(this.filterLogger.value)),this.formGroup.get("sortType").valueChanges.pipe(S(this.formGroup.value.sortType))).subscribe(()=>{this.updateView(this.allLoggers),this.cdr.markForCheck()});this.subscriptions.push(e),this.sortStatus=this.formGroup.value.sortType?"\u0E21\u0E32\u0E01 - \u0E19\u0E49\u0E2D\u0E22":"\u0E19\u0E49\u0E2D\u0E22 - \u0E21\u0E32\u0E01"}isAllSelected(){return this.filterLogger.value.includes("all")}matchesFilters(t,e){if(e.length===0||e.includes("all"))return!0;let i=[];return e.includes("allWarning")&&i.push(t.numberWarning>0&&!t.warningDetector),e.includes("allSmokeDetect")&&i.push(t.warningDetector===!0),this.filterIsAnd?i.every(Boolean):i.some(Boolean)}updateView(t=[]){let e=this.filterLogger.value??["all"],i=t.filter(s=>this.matchesFilters(s,e)),l=!!this.formGroup.value.sortType;i.sort((s,g)=>{let I=l?g.numberWarning-s.numberWarning:s.numberWarning-g.numberWarning;if(I!==0)return I;let B=Number(g.warningDetector)-Number(s.warningDetector);return B!==0?B:s.firstName.localeCompare(g.firstName,"th")}),this.onShowAllLoggers=[...i],this.sortStatus=l?"\u0E21\u0E32\u0E01 - \u0E19\u0E49\u0E2D\u0E22":"\u0E19\u0E49\u0E2D\u0E22 - \u0E21\u0E32\u0E01"}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}onSelectChange(t){let e=t.value||[],i=this.wasAllSelected;e.includes("all")&&e.length>1?i?this.filterLogger.setValue(e.filter(s=>s!=="all"),{emitEvent:!1}):this.filterLogger.setValue(["all"],{emitEvent:!1}):e.length==0&&this.filterLogger.setValue(["all"],{emitEvent:!1}),this.wasAllSelected=(this.filterLogger.value??e).includes("all"),this.updateView(this.allLoggers)}get allWarning(){return this.allLoggers.filter(t=>t.numberWarning>0)}onToggleSort(){let t=!!this.formGroup.value.sortType;this.sortStatus=t?"\u0E21\u0E32\u0E01 - \u0E19\u0E49\u0E2D\u0E22":"\u0E19\u0E49\u0E2D\u0E22 - \u0E21\u0E32\u0E01",this.updateView(this.allLoggers)}navigateToLoggerDetail(){this.router.navigate(["/pages","logger"])}navigateToResetLogger(t,e){let i=this.dialog.open(E,{enterAnimationDuration:t,exitAnimationDuration:e})}static \u0275fac=function(e){return new(e||n)(c(K),c(j),c(de),c(pe),c(M),c(G))};static \u0275cmp=v({type:n,selectors:[["app-dashboard"]],decls:28,vars:4,consts:[["menu","matMenu"],[1,"pt-2"],[1,"container"],[1,"row","w-100"],[1,"col-3","pt-2"],[1,"mat-input-form"],[1,"w-100"],["multiple","",3,"selectionChange","formControl"],[3,"value"],[1,"col-3","ps-0","pe-0","d-flex","align-items-center"],["ngNativeValidate","",1,"example-form",3,"formGroup"],["formControlName","sortType",3,"change"],[1,"offset-3","col-3","ps-0","pe-0","d-flex","align-items-center","justify-content-end"],["matButton","","type","button",1,"btn","btn-light",3,"matMenuTriggerFor"],["xmlns","http://www.w3.org/2000/svg","height","24px","viewBox","0 -960 960 960","width","24px","fill","000"],["d","m370-80-16-128q-13-5-24.5-12T307-235l-119 50L78-375l103-78q-1-7-1-13.5v-27q0-6.5 1-13.5L78-585l110-190 119 50q11-8 23-15t24-12l16-128h220l16 128q13 5 24.5 12t22.5 15l119-50 110 190-103 78q1 7 1 13.5v27q0 6.5-2 13.5l103 78-110 190-118-50q-11 8-23 15t-24 12L590-80H370Zm70-80h79l14-106q31-8 57.5-23.5T639-327l99 41 39-68-86-65q5-14 7-29.5t2-31.5q0-16-2-31.5t-7-29.5l86-65-39-68-99 42q-22-23-48.5-38.5T533-694l-13-106h-79l-14 106q-31 8-57.5 23.5T321-633l-99-41-39 68 86 64q-5 15-7 30t-2 32q0 16 2 31t7 30l-86 65 39 68 99-42q22 23 48.5 38.5T427-266l13 106Zm42-180q58 0 99-41t41-99q0-58-41-99t-99-41q-59 0-99.5 41T342-480q0 58 40.5 99t99.5 41Zm-2-140Z"],["mat-menu-item","",3,"click"],[1,"container",2,"margin-top","20px"],[1,"row"],[1,"col-6","col-sm-4","col-lg-3","mt-3"],[1,"col-6","col-sm-4","col-lg-3","mt-3",3,"click"],["appearance","outlined",1,"logger-card"],[1,"col-12"],[2,"margin","0.5rem 0 0 0"],[1,"badge","text-bg-secondary","w-100"],[2,"margin","0.3rem 0"],[1,"row","justify-content-center"],[1,"col-6","mt-1","pe-0","d-flex","justify-content-center"],["type","button",1,"btn","btn-secondary","w-100"],["matBadgeOverlap","false",1,"demo-section",2,"width","27px",3,"matBadge"],["matBadgeOverlap","false",1,"demo-section",2,"width","33px"],["src","images/icon/image8.png",2,"border-radius","0","height","40px"],["src","images/icon/image6.png",2,"border-radius","0","height","40px","margin-left","10px"]],template:function(e,i){if(e&1){let l=y();r(0,"mat-toolbar",1)(1,"mat-toolbar-row")(2,"div",2)(3,"div",3)(4,"div",4)(5,"form",5)(6,"mat-form-field",6)(7,"mat-label"),a(8,"Filter"),o(),r(9,"mat-select",7),h("selectionChange",function(g){return d(l),p(i.onSelectChange(g))}),x(10,Ve,2,2,"mat-option",8,w),o()()()(),r(12,"div",9)(13,"form",10)(14,"mat-slide-toggle",11),h("change",function(){return d(l),p(i.onToggleSort())}),a(15),o()()(),r(16,"div",12)(17,"button",13),V(),r(18,"svg",14),f(19,"path",15),o()(),k(),r(20,"mat-menu",null,0)(22,"button",16),h("click",function(){return d(l),p(i.navigateToResetLogger("0ms","0ms"))}),a(23,"Reset Logger \u0E17\u0E31\u0E49\u0E07\u0E2B\u0E21\u0E14"),o()()()()()()(),r(24,"div",17)(25,"div",18),x(26,Re,19,7,"div",19,w),o()()}if(e&2){let l=A(21);m(9),u("formControl",i.filterLogger),m(),L(i.filterLogList),m(3),u("formGroup",i.formGroup),m(2),F("Warning ",i.sortStatus,""),m(2),u("matMenuTriggerFor",l),m(9),L(i.onShowAllLoggers)}},dependencies:[ye,xe,Le,Fe,Ie,be,Te,De,b,ve,he,fe,C,ee,Q,U,X,le,ae,ne,se,ce,ge,me,oe,te,ie,re,Ce,Me,we,Se,Ee,_e],styles:[".logger-card[_ngcontent-%COMP%]{max-width:400px}.logger-card-footer[_ngcontent-%COMP%]{padding:16px}mat-icon[_ngcontent-%COMP%]{font-size:20px}.mat-toolbar[_ngcontent-%COMP%]{background:#212529;color:#fff}.example-form[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]{margin:8px 0;display:block}.logger-card.alert[_ngcontent-%COMP%]{padding:0;border:2px solid #EF4444;background-color:#611515;box-shadow:none;color:#fff}.logger-card.warning[_ngcontent-%COMP%]{padding:0;border:2px solid #D88C0C;box-shadow:none;color:#fff}"],changeDetection:0})};export{Be as DashboardComponent};
