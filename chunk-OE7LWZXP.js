import{a as mt}from"./chunk-7Q465SDF.js";import{a as ht,b as ut,c as dt}from"./chunk-JKVJU65Z.js";import{b as ct}from"./chunk-NWAZ3BDK.js";import{f as N,h as W}from"./chunk-U6AR7ORX.js";import{$ as G,Ba as et,Ca as it,Fa as at,Ga as nt,Ia as rt,Ma as st,Na as ot,Oa as lt,_ as B,ca as U,ia as Q,ja as H,la as z,ma as X,na as $,oa as Y,ta as J,ua as K,va as tt}from"./chunk-F2333JFI.js";import"./chunk-4MNQX6OK.js";import{$b as R,Ab as D,Bb as _,Cb as T,Db as s,Eb as a,Fb as o,Jb as j,Nb as w,Ob as O,Sb as p,Tb as g,Ub as f,Va as d,Xb as k,Y as A,Yb as h,Zb as Z,_a as C,ac as F,bc as I,cc as V,ec as q,fb as S,gb as P,ja as x,ka as b,la as c,lb as E,ma as y,sb as v,tb as L,wa as M,yb as m}from"./chunk-77CAPYCR.js";import"./chunk-2NFLSA4Y.js";var pt=(()=>{class r{static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275mod=P({type:r})}static{this.\u0275inj=A({})}}return r})();var xt=["selectButton"],bt=["select"],vt=["chart"];function Ot(r,t){r&1&&(c(),o(0,"image",29))}function yt(r,t){r&1&&(c(),o(0,"rect",30))}function Ct(r,t){if(r&1&&(c(),o(0,"polyline",31)),r&2){let e=O();v("points",e.svgPoints)}}function St(r,t){if(r&1&&(c(),o(0,"circle",45),s(1,"text",46),h(2,"Start"),a()),r&2){let e=O();v("cx",e.startPoint.x)("cy",e.startPoint.y),d(),v("x",e.startPoint.x+15)("y",e.startPoint.y)}}function Et(r,t){if(r&1&&(s(0,"span",37),h(1),a()),r&2){let e=O();d(),R(" Page ",e.currentPage," (",e.currentPageData.length," records) ")}}function wt(r,t){if(r&1&&(s(0,"mat-option",44),h(1),a()),r&2){let e=t.$implicit;L("value",e.value),d(),Z(e.label)}}var gt=class r{constructor(t,e){this.router=t;this.route=e;this.areaSmoothChart={series:[{name:"series1",data:[]}],chart:{height:350,type:"area"},dataLabels:{enabled:!1},stroke:{curve:"smooth"},xaxis:{categories:[]},tooltip:{x:{format:"HH:mm:ss"}}},this.areaSmoothChartMaps={series:[{name:"Route Path",data:[]}],chart:{type:"line",height:400,zoom:{enabled:!0}},xaxis:{type:"numeric",title:{text:"Longitude"}},yaxis:{title:{text:"Latitude"}},stroke:{curve:"smooth",width:3}}}selectButtonEl;select;chart;options=[{value:"all",label:"\u0E17\u0E31\u0E49\u0E07\u0E2B\u0E21\u0E14"},{value:"warningAfr",label:"warning AFR"},{value:"avgAfr",label:"Average AFR"}];chartFilter=new X(["all"],{nonNullable:!0});showRoutePath=!0;toppingList=["Extra cheese","Mushroom","Onion","Pepperoni","Sausage","Tomato"];svgPoints="";startPoint={x:0,y:0,lat:0,long:0};hasRouteData=!1;trackImage=null;pageSize=10;currentPageData=[];currentPage=1;showPageDataOnly=!0;subscriptions=[];areaSmoothChart;areaSmoothChartMaps;allLogger=[];ngOnInit(){}showWarningAfr=!0;showAverageAfr=!0;overlayEl;ngAfterViewInit(){let t=this.selectButtonEl.nativeElement.querySelector(".mat-button-focus-overlay, .mat-mdc-button-ripple, .mdc-button__ripple");this.overlayEl=t||void 0}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}navigateToDashboard(){this.router.navigate(["/pages","dashboard"])}formatGpsTimeToText(t){let e=t.slice(0,2),i=t.slice(2,4),n=parseFloat(t.slice(4)),l=Math.floor(n).toString().padStart(2,"0"),u=Math.round(n%1*1e3).toString().padStart(3,"0");return`${e}:${i}:${l}:${u}`}formatToTimeLabel(t){let e=t.slice(0,2),i=t.slice(2,4),n=Math.floor(parseFloat(t.slice(4))).toString().padStart(2,"0");return`${e}:${i}:${n}`}updateChartWithData(t){let e=t.slice(-1e3),i=e.map(l=>({x:this.formatGpsTimeToText(l.time),y:parseFloat(l.velocity.toString())})),n=e.map(l=>({x:this.formatGpsTimeToText(l.time),y:parseFloat(l.height)}));this.areaSmoothChart.series=[{name:"velocity",data:i},{name:"height",data:n}],this.areaSmoothChart.xaxis={categories:e.map(l=>this.formatToTimeLabel(l.time))},this.chart&&this.chart.updateOptions({series:this.areaSmoothChart.series,xaxis:this.areaSmoothChart.xaxis}),this.updateMapWithAllData()}onToggleChartMode(){console.log("Toggle chart mode:",this.showPageDataOnly),this.showPageDataOnly?this.updateChartWithPageData(this.currentPageData):this.allLogger.length>0&&this.updateChartWithData(this.allLogger)}updateChartWithPageData(t){if(!t||t.length===0){this.areaSmoothChart.series=[{name:"velocity",data:[]},{name:"height",data:[]}],this.areaSmoothChart.xaxis={categories:[]},this.chart&&this.chart.updateOptions({series:this.areaSmoothChart.series,xaxis:this.areaSmoothChart.xaxis});return}let e=t.map(n=>({x:this.formatGpsTimeToText(n.time),y:parseFloat(n.velocity.toString())})),i=t.map(n=>({x:this.formatGpsTimeToText(n.time),y:parseFloat(n.height)}));this.areaSmoothChart.series=[{name:"velocity",data:e},{name:"height",data:i}],this.areaSmoothChart.xaxis={categories:t.map(n=>this.formatToTimeLabel(n.time))},this.chart&&this.chart.updateOptions({series:this.areaSmoothChart.series,xaxis:this.areaSmoothChart.xaxis}),this.updateMapWithPageData(t)}updateMapWithPageData(t){if(!t||t.length===0){this.areaSmoothChartMaps.series=[{name:"Route Path",data:[]}];return}let e=t.filter(i=>i.lat&&i.long).map(i=>({x:parseFloat(i.long),y:parseFloat(i.lat)})).filter(i=>!isNaN(i.x)&&!isNaN(i.y));console.log("GPS Path Data:",e),this.areaSmoothChartMaps={series:[{name:"Route Path",data:e}],chart:{type:"line",height:400,zoom:{enabled:!0}},xaxis:{type:"numeric",title:{text:"Longitude"}},yaxis:{title:{text:"Latitude"}},stroke:{curve:"smooth",width:3,colors:["#007bff"]},markers:{size:4,colors:["#007bff"],strokeColors:"#fff",strokeWidth:2},tooltip:{x:{formatter:function(i){return"Longitude: "+i.toFixed(6)}},y:{formatter:function(i){return"Latitude: "+i.toFixed(6)}}}}}updateMapWithAllData(){if(!this.allLogger||this.allLogger.length===0)return;let t=this.allLogger.slice(-1e3);this.updateMapWithPageData(t)}onMouseEnterZoom(){document.body.style.overflow="hidden"}onMouseLeaveZoom(){document.body.style.overflow="auto"}get triggerText(){let t=this.chartFilter.value;return!t||t.length===0||t.includes("all")?"\u0E17\u0E31\u0E49\u0E07\u0E2B\u0E21\u0E14":t.length===1?this.options.find(e=>e.value===t[0])?.label??"\u0E40\u0E25\u0E37\u0E2D\u0E01\u0E15\u0E31\u0E27\u0E01\u0E23\u0E2D\u0E07":`\u0E40\u0E25\u0E37\u0E2D\u0E01\u0E41\u0E25\u0E49\u0E27 ${t.length}`}onMultiSelectChange(t){let e=t.value??[],i=this.chartFilter.value.includes("all");e.includes("all")&&e.length>1&&(i?this.chartFilter.setValue(e.filter(u=>u!=="all"),{emitEvent:!1}):this.chartFilter.setValue(["all"],{emitEvent:!1}));let l=this.chartFilter.value;this.showWarningAfr=l.includes("all")||l.includes("warningAfr"),this.showAverageAfr=l.includes("all")||l.includes("avgAfr"),this.updateChartVisibility()}updateChartVisibility(){}static \u0275fac=function(e){return new(e||r)(C(W),C(N))};static \u0275cmp=S({type:r,selectors:[["app-logger"]],viewQuery:function(e,i){if(e&1&&(p(xt,5,M),p(bt,5),p(vt,5)),e&2){let n;g(n=f())&&(i.selectButtonEl=n.first),g(n=f())&&(i.select=n.first),g(n=f())&&(i.chart=n.first)}},features:[q([{provide:st,useValue:{overlayPanelClass:"chart-filter-overlay-180"}}])],decls:94,vars:5,consts:[["selectButton",""],["select",""],[1,"pt-2"],[1,"container"],[1,"row","w-100"],[1,"col-3","pt-2"],[1,"mat-input-form"],[1,"w-100"],["matInput","","disabled","","value","Thailand Super Pickup D2",1,"text-center"],["matInput","","disabled","","value","Pickup",1,"text-center"],["matInput","","disabled","","value","Race 5",1,"text-center"],["matInput","","disabled","","value","\u0E19\u0E32\u0E22\u0E17\u0E14\u0E2A\u0E2D\u0E1A TEST01",1,"text-center"],[1,"container",2,"margin-top","20px"],[1,"col-2","pt-2"],["matInput","","disabled","","value","8",1,"text-center"],["matInput","","disabled","","value","TSS001",1,"text-center"],["matInput","","disabled","","value","Offline",1,"text-center"],["matInput","","disabled","","value","0",1,"text-center"],[1,"col-4","pt-2"],["type","button",1,"btn","btn-warning","w-100","h-50","text-light"],[1,"col-12"],[1,"card"],[1,"card-header"],[1,"card-body"],[1,"form-check","form-switch","mb-2"],["type","checkbox","id","toggleRoutePath",1,"form-check-input",3,"ngModelChange","ngModel"],["for","toggleRoutePath",1,"form-check-label"],[1,"track-image-container","text-center"],["viewBox","0 0 800 600",2,"max-width","800px","max-height","600px"],["href","images/map-race/outline-map-baangsan.png",2,"max-width","800px","max-height","600px"],["fill","#ffffff",2,"max-width","800px","max-height","600px"],["fill","none","stroke","#007bff","stroke-width","2","opacity","0.9"],[1,"mt-3","d-flex","align-items-center","gap-4","flex-wrap"],[1,"row","w-100","mt-5"],[1,"col-md-12"],[1,"card",2,"margin-bottom","0px"],[1,"card-header","d-flex","justify-content-between","align-items-center"],[1,"badge","bg-primary","ms-2"],[1,"d-flex","align-items-center","gap-2"],[1,"form-check","form-switch"],["type","button","mat-raised-button","","color","accent",1,"chart-filter-btn",3,"click"],["xmlns","http://www.w3.org/2000/svg","height","20","viewBox","0 -960 960 960","width","20","fill","currentColor","aria-hidden","true",1,"btn-icon"],["d","m370-80-16-128q-13-5-24.5-12T307-235l-119 50L78-375l103-78q-1-7-1-13.5v-27q0-6.5 1-13.5L78-585l110-190 119 50q11-8 23-15t24-12l16-128h220l16 128q13 5 24.5 12t22.5 15l119-50 110 190-103 78q1 7 1 13.5v27q0 6.5-2 13.5l103 78-110 190-118-50q-11 8-23 15t-24 12L590-80H370Zm70-80h79l14-106q31-8 57.5-23.5T639-327l99 41 39-68-86-65q5-14 7-29.5t2-31.5q0-16-2-31.5t-7-29.5l86-65-39-68-99 42q-22-23-48.5-38.5T533-694l-13-106h-79l-14 106q-31 8-57.5 23.5T321-633l-99-41-39 68 86 64q-5 15-7 30t-2 32q0 16 2 31t7 30l-86 65 39 68 99-42q22 23 48.5 38.5T427-266l13 106Zm42-180q58 0 99-41t41-99q0-58-41-99t-99-41q-59 0-99.5 41T342-480q0 58 40.5 99t99.5 41Zm-2-140Z"],["multiple","","panelClass","chart-filter-panel",3,"selectionChange"],[3,"value"],["r","10","fill","#28a745","stroke","#fff","stroke-width","3"],["font-size","20","fill","#28a745","font-weight","bold"]],template:function(e,i){if(e&1){let n=j();s(0,"mat-toolbar",2)(1,"mat-toolbar-row")(2,"div",3)(3,"div",4)(4,"div",5)(5,"form",6)(6,"mat-form-field",7)(7,"mat-label"),h(8,"Race"),a(),o(9,"input",8),a()()(),s(10,"div",5)(11,"form",6)(12,"mat-form-field",7)(13,"mat-label"),h(14,"\u0E23\u0E38\u0E48\u0E19"),a(),o(15,"input",9),a()()(),s(16,"div",5)(17,"form",6)(18,"mat-form-field",7)(19,"mat-label"),h(20,"Session"),a(),o(21,"input",10),a()()(),s(22,"div",5)(23,"form",6)(24,"mat-form-field",7)(25,"mat-label"),h(26,"\u0E0A\u0E37\u0E48\u0E2D\u0E19\u0E31\u0E01\u0E41\u0E02\u0E48\u0E07"),a(),o(27,"input",11),a()()()()()()(),s(28,"div",12)(29,"div",4)(30,"div",13)(31,"form",6)(32,"mat-form-field",7)(33,"mat-label"),h(34,"\u0E2B\u0E21\u0E32\u0E22\u0E40\u0E25\u0E02\u0E23\u0E16"),a(),o(35,"input",14),a()()(),s(36,"div",13)(37,"form",6)(38,"mat-form-field",7)(39,"mat-label"),h(40,"Logger ID"),a(),o(41,"input",15),a()()(),s(42,"div",13)(43,"form",6)(44,"mat-form-field",7)(45,"mat-label"),h(46,"Session"),a(),o(47,"input",16),a()()(),s(48,"div",13)(49,"form",6)(50,"mat-form-field",7)(51,"mat-label"),h(52,"Warning"),a(),o(53,"input",17),a()()(),s(54,"div",18)(55,"button",19),h(56," Clear Warning "),a()()(),s(57,"div",4)(58,"div",20)(59,"div",21)(60,"div",22)(61,"h5"),h(62,"Racer Detail"),a()(),s(63,"div",23)(64,"div",24)(65,"input",25),V("ngModelChange",function(u){return x(n),I(i.showRoutePath,u)||(i.showRoutePath=u),b(u)}),a(),s(66,"label",26),h(67,"\u0E41\u0E2A\u0E14\u0E07\u0E40\u0E2A\u0E49\u0E19\u0E17\u0E32\u0E07\u0E01\u0E32\u0E23\u0E27\u0E34\u0E48\u0E07"),a()(),s(68,"div",27),c(),s(69,"svg",28),o(70,"image",29),E(71,Ot,1,0,":svg:image",29)(72,yt,1,0,":svg:rect",30)(73,Ct,1,1,":svg:polyline",31)(74,St,3,4),a()(),y(),o(75,"div",32),a()()()(),s(76,"div",33)(77,"div",34)(78,"div",35)(79,"div",36)(80,"h5"),h(81," Graph Realtime Average AFR "),E(82,Et,2,2,"span",37),a(),s(83,"div",38)(84,"div",39)(85,"button",40,0),w("click",function(){x(n);let u=k(90);return b(u.open())}),c(),s(87,"svg",41),o(88,"path",42),a(),y(),s(89,"mat-select",43,1),w("selectionChange",function(u){return x(n),b(i.onMultiSelectChange(u))}),_(91,wt,2,2,"mat-option",44,D),a()()()()(),o(93,"div",23),a()()()()}e&2&&(d(65),F("ngModel",i.showRoutePath),d(6),m(i.trackImage?71:i.trackImage?-1:72),d(2),m(i.showRoutePath?73:-1),d(),m(i.hasRouteData?74:-1),d(8),m(i.currentPageData.length>0?82:-1),d(9),T(i.options))},dependencies:[J,Y,U,Q,H,$,z,it,et,tt,nt,at,lt,ot,rt,K,G,B,mt,ct,dt,ut,ht,pt],styles:['@charset "UTF-8";.mat-toolbar[_ngcontent-%COMP%]{background:#212529;color:#fff}.hidden-overlay[_ngcontent-%COMP%]{display:none!important}button[mat-raised-button][_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.25rem;text-transform:none}.chart-filter-btn[_ngcontent-%COMP%]   .mat-mdc-select-trigger[_ngcontent-%COMP%], .chart-filter-btn[_ngcontent-%COMP%]   .mat-mdc-select-arrow[_ngcontent-%COMP%]{display:none!important}.chart-filter-btn[_ngcontent-%COMP%]   .mat-mdc-select[_ngcontent-%COMP%]{position:absolute!important;width:0!important;height:0!important;opacity:0!important;overflow:hidden!important}.chart-filter-overlay-180[_ngcontent-%COMP%]{width:180px!important;min-width:180px!important}.chart-filter-panel[_ngcontent-%COMP%]{min-width:180px!important}.chart-filter-btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.5rem;text-transform:none}.chart-filter-btn[_ngcontent-%COMP%]   .btn-label[_ngcontent-%COMP%]{max-width:160px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}']})};export{gt as LoggerComponent};
