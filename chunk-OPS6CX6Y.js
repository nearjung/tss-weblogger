import{L as i,d as a}from"./chunk-EXJ2PHFM.js";var u={admin:{password:"pass1235",role:"admin"},scruitineer:{password:"pass2356",role:"scruitineer"}},s="auth_state_v1",l=class r{_user$=new a(this.readFromLS());user$=this._user$.asObservable();readFromLS(){try{return JSON.parse(localStorage.getItem(s)||"null")}catch{return null}}writeToLS(e){e?localStorage.setItem(s,JSON.stringify(e)):localStorage.removeItem(s)}login(e,t){let o=u[e];if(!o||o.password!==t)return{ok:!1,error:"Invalid username or password"};let n={username:e,role:o.role};return this._user$.next(n),this.writeToLS(n),{ok:!0}}logout(){this._user$.next(null),this.writeToLS(null)}get current(){return this._user$.value}isLoggedIn(){return!!this.current}hasAnyRole(...e){let t=this.current?.role;return!!t&&e.includes(t)}static \u0275fac=function(t){return new(t||r)};static \u0275prov=i({token:r,factory:r.\u0275fac,providedIn:"root"})};export{l as a};
